# https://gittup.org/tup/manual.html

CFLAGS = -DCONFIG_VERSION="\"@(VERSION)\""

ifdef BIGNUM
  CFLAGS += -DCONFIG_BIGNUM
endif

ifdef LTO
  CFLAGS += -DCONFIG_LTO
endif

ifdef PREFIX
  CFLAGS += -DCONFIG_PREFIX="\"@(PREFIX)\""
endif

CFLAGS += -D_GNU_SOURCE

DEPS = ../cutils/cutils.o
DEPS += ../libbf/libbf.o
DEPS += ../libregexp/libregexp.o
DEPS += ../libunicode/libunicode.o
DEPS += ../quickjs/quickjs.o
DEPS += ../quickjs-libc/quickjs-libc.o

: qjsc.c $(DEPS) |> gcc -Wall %f $(DEPS) -o %o $(CFLAGS) |> qjsc
