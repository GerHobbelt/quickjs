# https://gittup.org/tup/manual.html
include_rules

CFLAGS += -DCONFIG_VERSION="\"@(VERSION)\""

ifdef BIGNUM
  CFLAGS += -DCONFIG_BIGNUM
endif

ifdef LTO
  CFLAGS += -DCONFIG_LTO
  LDFLAGS += -flto
endif

ifdef PREFIX
  CFLAGS += -DCONFIG_PREFIX="\"@(PREFIX)\""
endif

DEPS = ../cutils/cutils.o
DEPS += ../libbf/libbf.o
DEPS += ../libregexp/libregexp.o
DEPS += ../libunicode/libunicode.o
DEPS += ../quickjs/quickjs.o
DEPS += ../quickjs-libc/quickjs-libc.o

: qjs.c $(DEPS) |> !compile_c_program |> qjs

