# https://gittup.org/tup/manual.html
include_rules

UNICODE_FILES=./downloaded/CaseFolding.txt \
./downloaded/DerivedNormalizationProps.txt \
./downloaded/PropList.txt \
./downloaded/SpecialCasing.txt \
./downloaded/CompositionExclusions.txt \
./downloaded/ScriptExtensions.txt \
./downloaded/UnicodeData.txt \
./downloaded/DerivedCoreProperties.txt \
./downloaded/NormalizationTest.txt \
./downloaded/Scripts.txt \
./downloaded/PropertyValueAliases.txt \
./downloaded/emoji-data.txt

ifdef WIN32
  UNICODE_GEN = ./unicode_gen.exe
  UNICODE_GEN_CMD = wine $(UNICODE_GEN)
else
  UNICODE_GEN = ./unicode_gen
  UNICODE_GEN_CMD = $(UNICODE_GEN)
endif

: ../cutils/cutils.o unicode_gen.c |> !compile_c_program |> $(UNICODE_GEN)

: $(UNICODE_GEN) $(UNICODE_FILES) |> $(UNICODE_GEN_CMD) downloaded %o |> libunicode-table.h

: libunicode.c | libunicode-table.h |> !compile_c_object |> libunicode.o
